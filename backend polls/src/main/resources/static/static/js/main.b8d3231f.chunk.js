(this["webpackJsonppolling-app-client"]=this["webpackJsonppolling-app-client"]||[]).push([[0],{167:function(e,t,a){},170:function(e,t,a){},177:function(e,t,a){},207:function(e,t,a){},225:function(e,t,a){},312:function(e,t,a){},313:function(e,t,a){},316:function(e,t,a){},317:function(e,t,a){},318:function(e,t,a){},327:function(e,t,a){},334:function(e,t,a){"use strict";a.r(t);var s=a(2),n=a(0),r=a(25),i=a.n(r),o=(a(167),a(1)),l=(a(77),a(42)),c=a(8),u=a(9),h=a(11),d=a(12),p=a(13),m=(a(124),a(85)),j=(a(170),a(33)),b=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_API_BASE_URL||"http://localhost:5000/api",g="accessToken",v=function(e){var t=new Headers({"Content-Type":"application/json"});localStorage.getItem(g)&&t.append("Authorization","Bearer "+localStorage.getItem(g));var a={headers:t};return e=Object.assign({},a,e),fetch(e.url,e).then((function(e){return e.json().then((function(t){return e.ok?t:Promise.reject(t)}))}))};function f(e,t){return v({url:b+"/polls?page="+(e=e||0)+"&size="+(t=t||30),method:"GET"})}function O(e,t,a){return v({url:b+"/users/"+e+"/polls?page="+(t=t||0)+"&size="+(a=a||30),method:"GET"})}function x(e,t,a){return v({url:b+"/users/"+e+"/votes?page="+(t=t||0)+"&size="+(a=a||30),method:"GET"})}a(58);var y=a(34),S=(a(68),a(41)),C=(a(143),a(104)),N=(a(175),a(123)),w=(a(177),a(32)),k=["#F44336","#e91e63","#9c27b0","#673ab7","#ff9800","#ff5722","#795548","#607d8b","#3f51b5","#2196F3","#00bcd4","#009688","#2196F3","#32c787","#00BCD4","#ff5652","#ffc107","#ff85af","#FF9800","#39bbb0","#4CAF50","#ffeb3b","#ffc107"];function P(e){e=e.substr(0,6);for(var t=0,a=0;a<e.length;a++)t=31*t+e.charCodeAt(a);var s=Math.abs(t%k.length);return k[s]}function L(e){var t=new Date(e),a=t.getMonth(),s=t.getFullYear();return["January","February","March","April","May","June","July","August","September","October","November","December"][a]+" "+s}function M(e){var t=new Date(e),a=t.getMonth(),s=t.getFullYear();return t.getDate()+" "+["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][a]+" "+s+" - "+t.getHours()+":"+t.getMinutes()}var A=N.a.Group;function E(e){return Object(s.jsxs)("div",{className:"cv-poll-choice",children:[Object(s.jsxs)("span",{className:"cv-poll-choice-details",children:[Object(s.jsxs)("span",{className:"cv-choice-percentage",children:[Math.round(100*e.percentVote)/100,"%"]}),Object(s.jsx)("span",{className:"cv-choice-text",children:e.choice.text}),e.isSelected?Object(s.jsx)(S.a,{className:"selected-choice-icon",type:"check-circle-o"}):null]}),Object(s.jsx)("span",{className:e.isWinner?"cv-choice-percent-chart winner":"cv-choice-percent-chart",style:{width:e.percentVote+"%"}})]})}var U=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var s=arguments.length,n=new Array(s),r=0;r<s;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))).calculatePercentage=function(t){return 0===e.props.poll.totalVotes?0:100*t.voteCount/e.props.poll.totalVotes},e.isSelected=function(t){return e.props.poll.selectedChoice===t.id},e.getWinningChoice=function(){return e.props.poll.choices.reduce((function(e,t){return t.voteCount>e.voteCount?t:e}),{voteCount:-1/0})},e.getTimeRemaining=function(e){var t=new Date(e.expirationDateTime).getTime()-(new Date).getTime(),a=Math.floor(t/1e3%60),s=Math.floor(t/1e3/60%60),n=Math.floor(t/36e5%24),r=Math.floor(t/864e5);return r>0?r+" days left":n>0?n+" hours left":s>0?s+" minutes left":a>0?a+" seconds left":"less than a second left"},e}return Object(u.a)(a,[{key:"render",value:function(){var e=this,t=[];if(this.props.poll.selectedChoice||this.props.poll.expired){var a=this.props.poll.expired?this.getWinningChoice():null;this.props.poll.choices.forEach((function(n){t.push(Object(s.jsx)(E,{choice:n,isWinner:a&&n.id===a.id,isSelected:e.isSelected(n),percentVote:e.calculatePercentage(n)},n.id))}))}else this.props.poll.choices.forEach((function(e){t.push(Object(s.jsx)(N.a,{className:"poll-choice-radio",value:e.id,children:e.text},e.id))}));return Object(s.jsxs)("div",{className:"poll-content",children:[Object(s.jsxs)("div",{className:"poll-header",children:[Object(s.jsx)("div",{className:"poll-creator-info",children:Object(s.jsxs)(w.b,{className:"creator-link",to:"/users/".concat(this.props.poll.createdBy.username),children:[Object(s.jsx)(C.a,{className:"poll-creator-avatar",style:{backgroundColor:P(this.props.poll.createdBy.name)},children:this.props.poll.createdBy.name[0].toUpperCase()}),Object(s.jsx)("span",{className:"poll-creator-name",children:this.props.poll.createdBy.name}),Object(s.jsxs)("span",{className:"poll-creator-username",children:["@",this.props.poll.createdBy.username]}),Object(s.jsx)("span",{className:"poll-creation-date",children:M(this.props.poll.creationDateTime)})]})}),Object(s.jsx)("div",{className:"poll-question",children:this.props.poll.question})]}),Object(s.jsx)("div",{className:"poll-choices",children:Object(s.jsx)(A,{className:"poll-choice-radio-group",onChange:this.props.handleVoteChange,value:this.props.currentVote,children:t})}),Object(s.jsxs)("div",{className:"poll-footer",children:[this.props.poll.selectedChoice||this.props.poll.expired?null:Object(s.jsx)(y.a,{className:"vote-button",disabled:!this.props.currentVote,onClick:this.props.handleVoteSubmit,children:"Vote"}),Object(s.jsxs)("span",{className:"total-votes",children:[this.props.poll.totalVotes," votes"]}),Object(s.jsx)("span",{className:"separator",children:"\u2022"}),Object(s.jsx)("span",{className:"time-left",children:this.props.poll.expired?"Final results":this.getTimeRemaining(this.props.poll)})]})]})}}]),a}(n.Component),T=(a(200),a(144));function I(e){var t=Object(s.jsx)(S.a,{type:"loading-3-quarters",style:{fontSize:30},spin:!0});return Object(s.jsx)(T.a,{indicator:t,style:{display:"block",textAlign:"center",marginTop:30}})}a(207);var D=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(e){var s;return Object(c.a)(this,a),(s=t.call(this,e)).state={polls:[],page:0,size:10,totalElements:0,totalPages:0,last:!0,currentVotes:[],isLoading:!1},s.loadPollList=s.loadPollList.bind(Object(h.a)(s)),s.handleLoadMore=s.handleLoadMore.bind(Object(h.a)(s)),s}return Object(u.a)(a,[{key:"loadPollList",value:function(){var e,t=this,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30;this.props.username?"USER_CREATED_POLLS"===this.props.type?e=O(this.props.username,a,s):"USER_VOTED_POLLS"===this.props.type&&(e=x(this.props.username,a,s)):e=f(a,s),e&&(this.setState({isLoading:!0}),e.then((function(e){var a=t.state.polls.slice(),s=t.state.currentVotes.slice();t.setState({polls:a.concat(e.content),page:e.page,size:e.size,totalElements:e.totalElements,totalPages:e.totalPages,last:e.last,currentVotes:s.concat(Array(e.content.length).fill(null)),isLoading:!1})})).catch((function(e){t.setState({isLoading:!1})})))}},{key:"componentDidMount",value:function(){this.loadPollList()}},{key:"componentDidUpdate",value:function(e){this.props.isAuthenticated!==e.isAuthenticated&&(this.setState({polls:[],page:0,size:10,totalElements:0,totalPages:0,last:!0,currentVotes:[],isLoading:!1}),this.loadPollList())}},{key:"handleLoadMore",value:function(){this.loadPollList(this.state.page+1)}},{key:"handleVoteChange",value:function(e,t){var a=this.state.currentVotes.slice();a[t]=e.target.value,this.setState({currentVotes:a})}},{key:"handleVoteSubmit",value:function(e,t){var a=this;if(e.preventDefault(),!this.props.isAuthenticated)return this.props.history.push("/login"),void l.a.info({message:"Polling App",description:"Please login to vote."});var s=this.state.polls[t],n=this.state.currentVotes[t];(function(e){return v({url:b+"/polls/"+e.pollId+"/votes",method:"POST",body:JSON.stringify(e)})})({pollId:s.id,choiceId:n}).then((function(e){var s=a.state.polls.slice();s[t]=e,a.setState({polls:s})})).catch((function(e){401===e.status?a.props.handleLogout("/login","error","You have been logged out. Please login to vote"):l.a.error({message:"Polling App",description:e.message||"Sorry! Something went wrong. Please try again!"})}))}},{key:"render",value:function(){var e=this,t=[];return this.state.polls.forEach((function(a,n){t.push(Object(s.jsx)(U,{poll:a,currentVote:e.state.currentVotes[n],handleVoteChange:function(t){return e.handleVoteChange(t,n)},handleVoteSubmit:function(t){return e.handleVoteSubmit(t,n)}},a.id))})),Object(s.jsxs)("div",{className:"polls-container",children:[t,this.state.isLoading||0!==this.state.polls.length?null:Object(s.jsx)("div",{className:"no-polls-found",children:Object(s.jsx)("span",{children:"No Polls Found."})}),this.state.isLoading||this.state.last?null:Object(s.jsx)("div",{className:"load-more-polls",children:Object(s.jsxs)(y.a,{type:"dashed",onClick:this.handleLoadMore,disabled:this.state.isLoading,children:[Object(s.jsx)(S.a,{type:"plus"})," Load more"]})}),this.state.isLoading?Object(s.jsx)(I,{}):null]})}}]),a}(n.Component),V=Object(j.g)(D),F=(a(218),a(120)),z=a(10),R=(a(114),a(54)),_=(a(115),a(57)),q=(a(335),a(108)),B=(a(225),q.a.Option),J=_.a.Item,W=R.a.TextArea;function H(e){return Object(s.jsxs)(J,{validateStatus:e.choice.validateStatus,help:e.choice.errorMsg,className:"poll-form-row",children:[Object(s.jsx)(R.a,{placeholder:"Choice "+(e.choiceNumber+1),size:"large",value:e.choice.text,className:e.choiceNumber>1?"optional-choice":null,onChange:function(t){return e.handleChoiceChange(t,e.choiceNumber)}}),e.choiceNumber>1?Object(s.jsx)(S.a,{className:"dynamic-delete-button",type:"close",disabled:e.choiceNumber<=1,onClick:function(){return e.removeChoice(e.choiceNumber)}}):null]})}var G=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(e){var s;return Object(c.a)(this,a),(s=t.call(this,e)).validateQuestion=function(e){return 0===e.length?{validateStatus:"error",errorMsg:"Please enter your question!"}:e.length>140?{validateStatus:"error",errorMsg:"Question is too long (Maximum ".concat(140," characters allowed)")}:{validateStatus:"success",errorMsg:null}},s.validateChoice=function(e){return 0===e.length?{validateStatus:"error",errorMsg:"Please enter a choice!"}:e.length>40?{validateStatus:"error",errorMsg:"Choice is too long (Maximum ".concat(40," characters allowed)")}:{validateStatus:"success",errorMsg:null}},s.state={question:{text:""},choices:[{text:""},{text:""}],pollLength:{days:1,hours:0}},s.addChoice=s.addChoice.bind(Object(h.a)(s)),s.removeChoice=s.removeChoice.bind(Object(h.a)(s)),s.handleSubmit=s.handleSubmit.bind(Object(h.a)(s)),s.handleQuestionChange=s.handleQuestionChange.bind(Object(h.a)(s)),s.handleChoiceChange=s.handleChoiceChange.bind(Object(h.a)(s)),s.handlePollDaysChange=s.handlePollDaysChange.bind(Object(h.a)(s)),s.handlePollHoursChange=s.handlePollHoursChange.bind(Object(h.a)(s)),s.isFormInvalid=s.isFormInvalid.bind(Object(h.a)(s)),s}return Object(u.a)(a,[{key:"addChoice",value:function(e){var t=this.state.choices.slice();this.setState({choices:t.concat([{text:""}])})}},{key:"removeChoice",value:function(e){var t=this.state.choices.slice();this.setState({choices:[].concat(Object(z.a)(t.slice(0,e)),Object(z.a)(t.slice(e+1)))})}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),function(e){return v({url:b+"/polls",method:"POST",body:JSON.stringify(e)})}({question:this.state.question.text,choices:this.state.choices.map((function(e){return{text:e.text}})),pollLength:this.state.pollLength}).then((function(e){t.props.history.push("/")})).catch((function(e){401===e.status?t.props.handleLogout("/login","error","You have been logged out. Please login create poll."):l.a.error({message:"Polling App",description:e.message||"Sorry! Something went wrong. Please try again!"})}))}},{key:"handleQuestionChange",value:function(e){var t=e.target.value;this.setState({question:Object(o.a)({text:t},this.validateQuestion(t))})}},{key:"handleChoiceChange",value:function(e,t){var a=this.state.choices.slice(),s=e.target.value;a[t]=Object(o.a)({text:s},this.validateChoice(s)),this.setState({choices:a})}},{key:"handlePollDaysChange",value:function(e){var t=Object.assign(this.state.pollLength,{days:e});this.setState({pollLength:t})}},{key:"handlePollHoursChange",value:function(e){var t=Object.assign(this.state.pollLength,{hours:e});this.setState({pollLength:t})}},{key:"isFormInvalid",value:function(){if("success"!==this.state.question.validateStatus)return!0;for(var e=0;e<this.state.choices.length;e++){if("success"!==this.state.choices[e].validateStatus)return!0}}},{key:"render",value:function(){var e=this,t=[];return this.state.choices.forEach((function(a,n){t.push(Object(s.jsx)(H,{choice:a,choiceNumber:n,removeChoice:e.removeChoice,handleChoiceChange:e.handleChoiceChange},n))})),Object(s.jsxs)("div",{className:"new-poll-container",children:[Object(s.jsx)("h1",{className:"page-title",children:"Create Poll"}),Object(s.jsx)("div",{className:"new-poll-content",children:Object(s.jsxs)(_.a,{onSubmit:this.handleSubmit,className:"create-poll-form",children:[Object(s.jsx)(J,{validateStatus:this.state.question.validateStatus,help:this.state.question.errorMsg,className:"poll-form-row",children:Object(s.jsx)(W,{placeholder:"Enter your question",style:{fontSize:"16px"},autosize:{minRows:3,maxRows:6},name:"question",value:this.state.question.text,onChange:this.handleQuestionChange})}),t,Object(s.jsx)(J,{className:"poll-form-row",children:Object(s.jsxs)(y.a,{type:"dashed",onClick:this.addChoice,disabled:6===this.state.choices.length,children:[Object(s.jsx)(S.a,{type:"plus"})," Add a choice"]})}),Object(s.jsxs)(J,{className:"poll-form-row",children:[Object(s.jsx)(F.a,{xs:24,sm:4,children:"Poll length:"}),Object(s.jsxs)(F.a,{xs:24,sm:20,children:[Object(s.jsxs)("span",{style:{marginRight:"18px"},children:[Object(s.jsx)(q.a,{name:"days",defaultValue:"1",onChange:this.handlePollDaysChange,value:this.state.pollLength.days,style:{width:60},children:Array.from(Array(8).keys()).map((function(e){return Object(s.jsx)(B,{children:e},e)}))})," \xa0Days"]}),Object(s.jsxs)("span",{children:[Object(s.jsx)(q.a,{name:"hours",defaultValue:"0",onChange:this.handlePollHoursChange,value:this.state.pollLength.hours,style:{width:60},children:Array.from(Array(24).keys()).map((function(e){return Object(s.jsx)(B,{children:e},e)}))})," \xa0Hours"]})]})]}),Object(s.jsx)(J,{className:"poll-form-row",children:Object(s.jsx)(y.a,{type:"primary",htmlType:"submit",size:"large",disabled:this.isFormInvalid(),className:"create-poll-form-button",children:"Create Poll"})})]})})]})}}]),a}(n.Component),Y=(a(312),_.a.Item),Q=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){var e=_.a.create()(K);return Object(s.jsxs)("div",{className:"login-container",children:[Object(s.jsx)("h1",{className:"page-title",children:"Login"}),Object(s.jsx)("div",{className:"login-content",children:Object(s.jsx)(e,{onLogin:this.props.onLogin})})]})}}]),a}(n.Component),K=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(e){var s;return Object(c.a)(this,a),(s=t.call(this,e)).handleSubmit=s.handleSubmit.bind(Object(h.a)(s)),s}return Object(u.a)(a,[{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),this.props.form.validateFields((function(e,a){e||function(e){return v({url:b+"/auth/signin",method:"POST",body:JSON.stringify(e)})}(Object.assign({},a)).then((function(e){localStorage.setItem(g,e.accessToken),t.props.onLogin()})).catch((function(e){401===e.status?l.a.error({message:"Polling App",description:"Your Username or Password is incorrect. Please try again!"}):l.a.error({message:"Polling App",description:e.message||"Sorry! Something went wrong. Please try again!"})}))}))}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return Object(s.jsxs)(_.a,{onSubmit:this.handleSubmit,className:"login-form",children:[Object(s.jsx)(Y,{children:e("usernameOrEmail",{rules:[{required:!0,message:"Please input your username or email!"}]})(Object(s.jsx)(R.a,{prefix:Object(s.jsx)(S.a,{type:"user"}),size:"large",name:"usernameOrEmail",placeholder:"Username or Email"}))}),Object(s.jsx)(Y,{children:e("password",{rules:[{required:!0,message:"Please input your Password!"}]})(Object(s.jsx)(R.a,{prefix:Object(s.jsx)(S.a,{type:"lock"}),size:"large",name:"password",type:"password",placeholder:"Password"}))}),Object(s.jsxs)(Y,{children:[Object(s.jsx)(y.a,{type:"primary",htmlType:"submit",size:"large",className:"login-form-button",children:"Login"}),"Or ",Object(s.jsx)(w.b,{to:"/signup",children:"register now!"})]})]})}}]),a}(n.Component),$=Q,X=a(7),Z=(a(313),_.a.Item),ee=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(e){var s;return Object(c.a)(this,a),(s=t.call(this,e)).validateName=function(e){return e.length<4?{validateStatus:"error",errorMsg:"Name is too short (Minimum ".concat(4," characters needed.)")}:e.length>40?{validationStatus:"error",errorMsg:"Name is too long (Maximum ".concat(40," characters allowed.)")}:{validateStatus:"success",errorMsg:null}},s.validateEmail=function(e){return e?RegExp("[^@ ]+@[^@ ]+\\.[^@ ]+").test(e)?e.length>40?{validateStatus:"error",errorMsg:"Email is too long (Maximum ".concat(40," characters allowed)")}:{validateStatus:null,errorMsg:null}:{validateStatus:"error",errorMsg:"Email not valid"}:{validateStatus:"error",errorMsg:"Email may not be empty"}},s.validateUsername=function(e){return e.length<3?{validateStatus:"error",errorMsg:"Username is too short (Minimum ".concat(3," characters needed.)")}:e.length>15?{validationStatus:"error",errorMsg:"Username is too long (Maximum ".concat(15," characters allowed.)")}:{validateStatus:null,errorMsg:null}},s.validatePassword=function(e){return e.length<6?{validateStatus:"error",errorMsg:"Password is too short (Minimum ".concat(6," characters needed.)")}:e.length>20?{validationStatus:"error",errorMsg:"Password is too long (Maximum ".concat(20," characters allowed.)")}:{validateStatus:"success",errorMsg:null}},s.state={name:{value:""},username:{value:""},email:{value:""},password:{value:""}},s.handleInputChange=s.handleInputChange.bind(Object(h.a)(s)),s.handleSubmit=s.handleSubmit.bind(Object(h.a)(s)),s.validateUsernameAvailability=s.validateUsernameAvailability.bind(Object(h.a)(s)),s.validateEmailAvailability=s.validateEmailAvailability.bind(Object(h.a)(s)),s.isFormInvalid=s.isFormInvalid.bind(Object(h.a)(s)),s}return Object(u.a)(a,[{key:"handleInputChange",value:function(e,t){var a=e.target,s=a.name,n=a.value;this.setState(Object(X.a)({},s,Object(o.a)({value:n},t(n))))}},{key:"handleSubmit",value:function(e){var t=this;console.log("test"),e.preventDefault(),function(e){return v({url:b+"/auth/signup",method:"POST",body:JSON.stringify(e)})}({name:this.state.name.value,email:this.state.email.value,username:this.state.username.value,password:this.state.password.value}).then((function(e){l.a.success({message:"Polling App",description:"Thank you! You're successfully registered. Please Login to continue!"}),t.props.history.push("/login")})).catch((function(e){l.a.error({message:"Polling App",description:e.message||"Sorry! Something went wrong. Please try again!"})}))}},{key:"isFormInvalid",value:function(){return!("success"===this.state.name.validateStatus&&"success"===this.state.username.validateStatus&&"success"===this.state.email.validateStatus&&"success"===this.state.password.validateStatus)}},{key:"render",value:function(){var e=this;return Object(s.jsxs)("div",{className:"signup-container",children:[Object(s.jsx)("h1",{className:"page-title",children:"Sign Up"}),Object(s.jsx)("div",{className:"signup-content",children:Object(s.jsxs)(_.a,{onSubmit:this.handleSubmit,className:"signup-form",children:[Object(s.jsx)(Z,{label:"Full Name",validateStatus:this.state.name.validateStatus,help:this.state.name.errorMsg,children:Object(s.jsx)(R.a,{size:"large",name:"name",autoComplete:"off",placeholder:"Your full name",value:this.state.name.value,onChange:function(t){return e.handleInputChange(t,e.validateName)}})}),Object(s.jsx)(Z,{label:"Username",hasFeedback:!0,validateStatus:this.state.username.validateStatus,help:this.state.username.errorMsg,children:Object(s.jsx)(R.a,{size:"large",name:"username",autoComplete:"off",placeholder:"A unique username",value:this.state.username.value,onBlur:this.validateUsernameAvailability,onChange:function(t){return e.handleInputChange(t,e.validateUsername)}})}),Object(s.jsx)(Z,{label:"Email",hasFeedback:!0,validateStatus:this.state.email.validateStatus,help:this.state.email.errorMsg,children:Object(s.jsx)(R.a,{size:"large",name:"email",type:"email",autoComplete:"off",placeholder:"Your email",value:this.state.email.value,onBlur:this.validateEmailAvailability,onChange:function(t){return e.handleInputChange(t,e.validateEmail)}})}),Object(s.jsx)(Z,{label:"Password",validateStatus:this.state.password.validateStatus,help:this.state.password.errorMsg,children:Object(s.jsx)(R.a,{size:"large",name:"password",type:"password",autoComplete:"off",placeholder:"A password between 6 to 20 characters",value:this.state.password.value,onChange:function(t){return e.handleInputChange(t,e.validatePassword)}})}),Object(s.jsxs)(Z,{children:[Object(s.jsx)(y.a,{type:"primary",htmlType:"submit",size:"large",className:"signup-form-button",disabled:this.isFormInvalid(),children:"Sign up"}),"Already registed? ",Object(s.jsx)(w.b,{to:"/login",children:"Login now!"})]})]})})]})}},{key:"validateUsernameAvailability",value:function(){var e,t=this,a=this.state.username.value,s=this.validateUsername(a);"error"!==s.validateStatus?(this.setState({username:{value:a,validateStatus:"validating",errorMsg:null}}),(e=a,v({url:b+"/user/checkUsernameAvailability?username="+e,method:"GET"})).then((function(e){e.available?t.setState({username:{value:a,validateStatus:"success",errorMsg:null}}):t.setState({username:{value:a,validateStatus:"error",errorMsg:"This username is already taken"}})})).catch((function(e){t.setState({username:{value:a,validateStatus:"success",errorMsg:null}})}))):this.setState({username:Object(o.a)({value:a},s)})}},{key:"validateEmailAvailability",value:function(){var e,t=this,a=this.state.email.value,s=this.validateEmail(a);"error"!==s.validateStatus?(this.setState({email:{value:a,validateStatus:"validating",errorMsg:null}}),(e=a,v({url:b+"/user/checkEmailAvailability?email="+e,method:"GET"})).then((function(e){e.available?t.setState({email:{value:a,validateStatus:"success",errorMsg:null}}):t.setState({email:{value:a,validateStatus:"error",errorMsg:"This Email is already registered"}})})).catch((function(e){t.setState({email:{value:a,validateStatus:"success",errorMsg:null}})}))):this.setState({email:Object(o.a)({value:a},s)})}}]),a}(n.Component),te=(a(314),a(122)),ae=(a(316),a(317),function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){return Object(s.jsxs)("div",{className:"page-not-found",children:[Object(s.jsx)("h1",{className:"title",children:"404"}),Object(s.jsx)("div",{className:"desc",children:"The Page you're looking for was not found."}),Object(s.jsx)(w.b,{to:"/",children:Object(s.jsx)(y.a,{className:"go-back-btn",type:"primary",size:"large",children:"Go Back"})})]})}}]),a}(n.Component)),se=(a(318),function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){return Object(s.jsxs)("div",{className:"server-error-page",children:[Object(s.jsx)("h1",{className:"server-error-title",children:"500"}),Object(s.jsx)("div",{className:"server-error-desc",children:"Oops! Something went wrong at our Server. Why don't you go back?"}),Object(s.jsx)(w.b,{to:"/",children:Object(s.jsx)(y.a,{className:"server-error-go-back-btn",type:"primary",size:"large",children:"Go Back"})})]})}}]),a}(n.Component)),ne=te.a.TabPane,re=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(e){var s;return Object(c.a)(this,a),(s=t.call(this,e)).state={user:null,isLoading:!1},s.loadUserProfile=s.loadUserProfile.bind(Object(h.a)(s)),s}return Object(u.a)(a,[{key:"loadUserProfile",value:function(e){var t=this;this.setState({isLoading:!0}),function(e){return v({url:b+"/users/"+e,method:"GET"})}(e).then((function(e){t.setState({user:e,isLoading:!1})})).catch((function(e){404===e.status?t.setState({notFound:!0,isLoading:!1}):t.setState({serverError:!0,isLoading:!1})}))}},{key:"componentDidMount",value:function(){var e=this.props.match.params.username;this.loadUserProfile(e)}},{key:"componentDidUpdate",value:function(e){this.props.match.params.username!==e.match.params.username&&this.loadUserProfile(e.match.params.username)}},{key:"render",value:function(){if(this.state.isLoading)return Object(s.jsx)(I,{});if(this.state.notFound)return Object(s.jsx)(ae,{});if(this.state.serverError)return Object(s.jsx)(se,{});return Object(s.jsx)("div",{className:"profile",children:this.state.user?Object(s.jsxs)("div",{className:"user-profile",children:[Object(s.jsxs)("div",{className:"user-details",children:[Object(s.jsx)("div",{className:"user-avatar",children:Object(s.jsx)(C.a,{className:"user-avatar-circle",style:{backgroundColor:P(this.state.user.name)},children:this.state.user.name[0].toUpperCase()})}),Object(s.jsxs)("div",{className:"user-summary",children:[Object(s.jsx)("div",{className:"full-name",children:this.state.user.name}),Object(s.jsxs)("div",{className:"username",children:["@",this.state.user.username]}),Object(s.jsxs)("div",{className:"user-joined",children:["Joined ",L(this.state.user.joinedAt)]})]})]}),Object(s.jsx)("div",{className:"user-poll-details",children:Object(s.jsxs)(te.a,{defaultActiveKey:"1",animated:!1,tabBarStyle:{textAlign:"center"},size:"large",className:"profile-tabs",children:[Object(s.jsx)(ne,{tab:"".concat(this.state.user.pollCount," Polls"),children:Object(s.jsx)(V,{username:this.props.match.params.username,type:"USER_CREATED_POLLS"})},"1"),Object(s.jsx)(ne,{tab:"".concat(this.state.user.voteCount," Votes"),children:Object(s.jsx)(V,{username:this.props.match.params.username,type:"USER_VOTED_POLLS"})},"2")]})})]}):null})}}]),a}(n.Component),ie=(a(323),a(161)),oe=(a(325),a(52)),le=(a(327),a.p+"static/media/poll.7dd82f4b.svg"),ce=m.a.Header,ue=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(e){var s;return Object(c.a)(this,a),(s=t.call(this,e)).handleMenuClick=s.handleMenuClick.bind(Object(h.a)(s)),s}return Object(u.a)(a,[{key:"handleMenuClick",value:function(e){"logout"===e.key&&this.props.onLogout()}},{key:"render",value:function(){var e;return e=this.props.currentUser?[Object(s.jsx)(oe.a.Item,{children:Object(s.jsx)(w.b,{to:"/",children:Object(s.jsx)(S.a,{type:"home",className:"nav-icon"})})},"/"),Object(s.jsx)(oe.a.Item,{children:Object(s.jsx)(w.b,{to:"/poll/new",children:Object(s.jsx)("img",{src:le,alt:"poll",className:"poll-icon"})})},"/poll/new"),Object(s.jsx)(oe.a.Item,{className:"profile-menu",children:Object(s.jsx)(he,{currentUser:this.props.currentUser,handleMenuClick:this.handleMenuClick})},"/profile")]:[Object(s.jsx)(oe.a.Item,{children:Object(s.jsx)(w.b,{to:"/login",children:"Login"})},"/login"),Object(s.jsx)(oe.a.Item,{children:Object(s.jsx)(w.b,{to:"/signup",children:"Signup"})},"/signup")],Object(s.jsx)(ce,{className:"app-header",children:Object(s.jsxs)("div",{className:"container",children:[Object(s.jsx)("div",{className:"app-title",children:Object(s.jsx)(w.b,{to:"/",children:"Polling App"})}),Object(s.jsx)(oe.a,{className:"app-menu",mode:"horizontal",selectedKeys:[this.props.location.pathname],style:{lineHeight:"64px"},children:e})]})})}}]),a}(n.Component);function he(e){var t=Object(s.jsxs)(oe.a,{onClick:e.handleMenuClick,className:"profile-dropdown-menu",children:[Object(s.jsxs)(oe.a.Item,{className:"dropdown-item",disabled:!0,children:[Object(s.jsx)("div",{className:"user-full-name-info",children:e.currentUser.name}),Object(s.jsxs)("div",{className:"username-info",children:["@",e.currentUser.username]})]},"user-info"),Object(s.jsx)(oe.a.Divider,{}),Object(s.jsx)(oe.a.Item,{className:"dropdown-item",children:Object(s.jsx)(w.b,{to:"/users/".concat(e.currentUser.username),children:"Profile"})},"profile"),Object(s.jsx)(oe.a.Item,{className:"dropdown-item",children:"Logout"},"logout")]});return Object(s.jsx)(ie.a,{overlay:t,trigger:["click"],getPopupContainer:function(){return document.getElementsByClassName("profile-menu")[0]},children:Object(s.jsxs)("a",{className:"ant-dropdown-link",children:[Object(s.jsx)(S.a,{type:"user",className:"nav-icon",style:{marginRight:0}})," ",Object(s.jsx)(S.a,{type:"down"})]})})}var de=Object(j.g)(ue),pe=a(17),me=function(e){var t=e.component,a=e.authenticated,n=Object(pe.a)(e,["component","authenticated"]);return Object(s.jsx)(j.b,Object(o.a)(Object(o.a)({},n),{},{render:function(e){return a?Object(s.jsx)(t,Object(o.a)(Object(o.a)({},n),e)):Object(s.jsx)(j.a,{to:{pathname:"/login",state:{from:e.location}}})}}))},je=m.a.Content,be=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(e){var s;return Object(c.a)(this,a),(s=t.call(this,e)).state={currentUser:null,isAuthenticated:!1,isLoading:!1},s.handleLogout=s.handleLogout.bind(Object(h.a)(s)),s.loadCurrentUser=s.loadCurrentUser.bind(Object(h.a)(s)),s.handleLogin=s.handleLogin.bind(Object(h.a)(s)),l.a.config({placement:"topRight",top:70,duration:3}),s}return Object(u.a)(a,[{key:"loadCurrentUser",value:function(){var e=this;this.setState({isLoading:!0}),(localStorage.getItem(g)?v({url:b+"/user/me",method:"GET"}):Promise.reject("No access token set.")).then((function(t){e.setState({currentUser:t,isAuthenticated:!0,isLoading:!1})})).catch((function(t){e.setState({isLoading:!1})}))}},{key:"componentDidMount",value:function(){this.loadCurrentUser()}},{key:"handleLogout",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"You're successfully logged out.";localStorage.removeItem(g),this.setState({currentUser:null,isAuthenticated:!1}),this.props.history.push(e),l.a[t]({message:"Polling App",description:a})}},{key:"handleLogin",value:function(){l.a.success({message:"Polling App",description:"You're successfully logged in."}),this.loadCurrentUser(),this.props.history.push("/")}},{key:"render",value:function(){var e=this;return this.state.isLoading?Object(s.jsx)(I,{}):Object(s.jsxs)(m.a,{className:"app-container",children:[Object(s.jsx)(de,{isAuthenticated:this.state.isAuthenticated,currentUser:this.state.currentUser,onLogout:this.handleLogout}),Object(s.jsx)(je,{className:"app-content",children:Object(s.jsx)("div",{className:"container",children:Object(s.jsxs)(j.d,{children:[Object(s.jsx)(j.b,{exact:!0,path:"/",render:function(t){return Object(s.jsx)(V,Object(o.a)({isAuthenticated:e.state.isAuthenticated,currentUser:e.state.currentUser,handleLogout:e.handleLogout},t))}}),Object(s.jsx)(j.b,{path:"/login",render:function(t){return Object(s.jsx)($,Object(o.a)({onLogin:e.handleLogin},t))}}),Object(s.jsx)(j.b,{path:"/signup",component:ee}),Object(s.jsx)(j.b,{path:"/users/:username",render:function(t){return Object(s.jsx)(re,Object(o.a)({isAuthenticated:e.state.isAuthenticated,currentUser:e.state.currentUser},t))}}),Object(s.jsx)(me,{authenticated:this.state.isAuthenticated,path:"/poll/new",component:G,handleLogout:this.handleLogout}),Object(s.jsx)(j.b,{component:ae})]})})})]})}}]),a}(n.Component),ge=Object(j.g)(be),ve=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function fe(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}i.a.render(Object(s.jsx)(w.a,{children:Object(s.jsx)(ge,{})}),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("","/service-worker.js");ve?(!function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):fe(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):fe(e)}))}}()}},[[334,1,2]]]);
//# sourceMappingURL=main.b8d3231f.chunk.js.map